---
title: "ss_v_midclass"
author: "Mario"
date: 'Date created: `r Sys.Date()`'
output:
  html_notebook:
    code_folding: hide
    df_print: paged
    highlight: kate
    smart: yes
    theme: paper
    toc: no
  html_document:
    toc: no
---
# {.tabset} 

## abstract

ojfowj

## background

Empirically, Social Security is one of the U.S.'s most successful social programs.

## setup

Install and load packages
```{r message=FALSE, message=FALSE, warning=FALSE}

# install.packages('gapminder'); install.packages('DiagrammeR')
library(tidyverse); library(lubridate); library(gapminder); library(DiagrammeR); library(ggthemes)
```

Load poverty guideline data
```{r}
poverty_hist <- read.csv(file = 'hstpov1.csv', header = T, na.strings = '***') %>%
  mutate(yr = year
         ,yr_mth = yr + 0.54) %>%
  select(yr_mth, X2_senior, X1_senior, X4_all)

## Source: https://www2.census.gov/programs-surveys/cps/tables/time-series/historical-poverty-people/
```

Load social security cost of living adjustment data
```{r}
ss_cola <- read.delim(sep = ' '
             ,file = 'cola_1975-2019.txt'
             ,strip.white = T
             ,header = F
             ,col.names = c(1:4,'mth_name', 'yr', 'rmv', 'cola')) %>%
  mutate(mth_name = trimws(mth_name)
         ,mth = match(mth_name, month.name)
         ,yr_mth = yr + round(((mth - 0.5) / 12), 2)
         ,cola = as.numeric(sub(x= cola, '%', '')) / 100) %>%
  select(yr_mth, cola)

## Source: https://www.ssa.gov/cola/
```

Load Social Security historic benefits received data
```{r}

ss_hist <- read.csv(file = 'some_socsec.csv'
                    ,header = T
                    ,col.names = c('mth_day_yr', 'beneficiaries', 'mean_ss')) %>%
  mutate(mth_day_yr = mdy(mth_day_yr)
         ,yr = year(mth_day_yr)
         ,mth = month(mth_day_yr)
         ,yr_mth = yr + round(((mth - 0.5) / 12), 2)) %>%
  select(yr_mth, beneficiaries, mean_ss)

## Source: https://www.ssa.gov/cgi-bin/currentpay.cgi
```

Load income data
```{r}

y_hist <- read.csv(file = 'mdn_house-fam_y.csv', na.strings = 'NULL') %>%
  mutate(yr = if_else(year(mdy(DATE)) < 2020
                      ,year(mdy(DATE))
                      ,year(mdy(DATE)) - 100)
         ,mth = month(mdy(DATE))
         ,yr_mth = yr + round(((mth - 0.5) / 12), 2)) %>%
  select(yr_mth, mdn_house_y, mdn_fam_y)

## Source: https://www.census.gov/topics/income-poverty/income.html
```

Load household data
```{r}
house_hist <- read.csv(file = 'house_size.csv'
                       ,na.strings = 'NULL'
                       ,skip = 1) %>%
  mutate(yr_mth = as.numeric(substr(Year, 1, 4)) + 0.54
         ,households = as.integer(sub(x = households, ',', ''))) %>%
  select(yr_mth, households, mean_ppl_per_house)

```


Join Social Security data to median household income and poverty data
```{r}
my_test <- ss_hist %>%
  full_join(y_hist, by = 'yr_mth') %>%
  full_join(poverty_hist, by = 'yr_mth') %>%
  select(yr_mth, mdn_house_y) %>%
  filter(!is.na(mdn_house_y))
  

```

```{r}





my_work %>%
  full_join(poverty_hist, by = 'yr_mth') %>%
  arrange(yr_mth) %>%
  ggplot(mapping = aes(yr_mth, mean_ss)) +
  geom_line(mapping = aes(yr_mth, 24 * mean_ss / x2_senior), na.rm = T, color = 'orange', size = 1.5) +
  geom_line(data = mdn_y_hist, mapping = aes(yr_mth, 24 * mean_ss / 0.6667 / mdn_house_y), na.rm = T, color = 'red', size = 1.5) +
  labs(title = 'Mean social security benefits')
  
  
  
  


```




